<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Réponds à tes 10 questions</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Réponds à tes 10 questions</h1>
    <form id="user-quiz-form">
      <label><b>Ton nom :</b></label>
      <input type="text" name="creator" required placeholder="Ton prénom ou pseudo" style="width:100%;margin-bottom:16px;">
      <div id="questions-container"></div>
      <button type="submit">Générer le lien à partager</button>
    </form>
    <div id="quiz-link" style="margin-top:20px;"></div>
  </div>
  <script>
    const questions = [
      { q: "Que préfères-tu faire un samedi soir ?", options: ["Sortir avec des amis", "Regarder Netflix", "Dormir tôt", "Jouer à des jeux vidéo"] },
      { q: "Quel animal te ressemble le plus ?", options: ["Chat", "Chien", "Lion", "Panda"] },
      { q: "Si tu gagnes à la loterie, tu...", options: ["Voyages partout", "Achètes une maison", "Aides tes proches", "Investis tout"] },
      { q: "Ton plat préféré ?", options: ["Pizza", "Alloco", "Frites", "Poulet braisé"] },
      { q: "Ta boisson idéale ?", options: ["Eau", "Jus de bissap", "Soda", "Café"] },
      { q: "Tu ne peux pas vivre sans...", options: ["Ton téléphone", "La musique", "Le sport", "Le chocolat"] },
      { q: "Ton super-pouvoir rêvé ?", options: ["Voler", "Invisibilité", "Téléportation", "Lire dans les pensées"] },
      { q: "Ta saison préférée ?", options: ["Été", "Hiver", "Printemps", "Automne"] },
      { q: "Si tu étais un fruit ?", options: ["Mangue", "Banane", "Pastèque", "Orange"] },
      { q: "Ton style d’amitié ?", options: ["Toujours là pour les autres", "Le/la rigolo du groupe", "Le/la confident(e)", "Le/la discret(e)"] }
    ];
    const container = document.getElementById('questions-container');
    questions.forEach((q, i) => {
      let html = `<div class='question-block'><label>${i+1}. ${q.q}</label><br>`;
      q.options.forEach((opt, j) => {
        html += `<label style='display:block;margin-bottom:4px;'><input type='radio' name='a${i}' value='${j}' required> ${opt}</label>`;
      });
      html += `</div>`;
      container.innerHTML += html;
    });
    function btoaUnicode(str) {
      return btoa(unescape(encodeURIComponent(str)));
    }
    document.getElementById('user-quiz-form').onsubmit = function(e) {
      e.preventDefault();
      const data = new FormData(this);
      const creator = data.get('creator');
      const answers = [];
      for(let i=0; i<questions.length; i++) answers.push(parseInt(data.get('a'+i)));
      const payload = {creator, questions, answers};
      const encoded = encodeURIComponent(btoaUnicode(JSON.stringify(payload)));
      const url = `${window.location.origin}${window.location.pathname.replace('monquiz.html','index.html')}?userquiz=${encoded}`;
      document.getElementById('quiz-link').innerHTML = `<b>Partage ce lien à tes amis :</b><br><input style='width:100%' value='${url}' readonly onclick='this.select()'>`;
    }
  </script>
</body>
</html>
